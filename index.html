<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Label Generator</title>
<style>
body { font-family: Arial, sans-serif; margin:20px; display:flex; flex-direction:column; align-items:center; }
h2 { margin-bottom:5px; }
#instructions { max-width:800px; text-align:center; margin-bottom:20px; }
form { margin-bottom:20px; width:100%; max-width:800px; }
label { display:block; margin-bottom:8px; }
input[type="text"], input[type="number"] { width:100%; padding:4px; }
.slider-container { margin:8px 0; }
.advanced { display:none; border:1px solid #ccc; padding:10px; margin-top:10px; border-radius:8px; }
canvas { border:1px solid #ccc; border-radius:8px; margin-top:20px; }
.flex-row { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
button { margin-top:10px; padding:6px 12px; }
#labelsContainer { margin-top:10px; }
#allPreviews { display:flex; flex-direction:column; gap:38px; margin-top:20px; } /* 10mm spacing ~38px */
</style>
</head>
<body>

<h2>Interactive Label Generator</h2>
<div id="instructions">
Enter text for each line (all optional). Use advanced options for fonts, spacing, and sizes. You can create multiple labels below.
</div>

<form id="labelForm">
<h3>Label 1 (Primary Label - this is used to design the layout of your labels. I suggest you use the one where you want the most text for this)</h3>
<label>Line 1: <input id="line1" type="text" value="1st line"></label>
<label>Line 2: <input id="line2" type="text" value="2nd line"></label>
<label>Line 3: <input id="line3" type="text" value="3rd line"></label>

<button type="submit">Update Text</button>

<div class="slider-container">
<label>Large text size (line 1): <span id="largeSizeLabel">54</span>
<input id="largeSize" type="range" min="20" max="100" value="54">
</label>
</div>
<div class="slider-container">
<label>Small text size (line 2): <span id="smallSizeLabel">27</span>
<input id="smallSize" type="range" min="10" max="60" value="27">
</label>
</div>

<button type="button" id="toggleAdvanced">Show Advanced Options</button>
<div class="advanced" id="advancedOptions">
  <div class="slider-container">
    <label>Line 3 text size: <span id="line3SizeLabel">27</span>
      <input id="line3Size" type="range" min="10" max="60" value="27">
    </label>
    <label><input type="checkbox" id="link23" checked> Same as line 2 size</label>
  </div>

  <div class="slider-container">
    <label>Spacing line1竊値ine2: <span id="gap12Label">4</span>
      <input id="gap12" type="range" min="0" max="20" value="4">
    </label>
    <label>Spacing line2竊値ine3: <span id="gap23Label">3</span>
      <input id="gap23" type="range" min="0" max="20" value="3">
    </label>
    <label><input type="checkbox" id="linkGaps"> line2竊値ine3 same as line1竊値ine2</label>
  </div>

  <div class="slider-container">
    <label>Shift all text up/down: <span id="textShiftLabel">0</span>
      <input id="textShift" type="range" min="-20" max="20" value="0">
    </label>
  </div>

  <div class="slider-container flex-row">
    <label>Line 1 font: 
      <select id="font1"><option>Arial</option><option>Verdana</option><option>Courier New</option></select>
    </label>
    <label><input type="checkbox" id="bold1" checked> Bold</label>
    <label><input type="checkbox" id="italic1"> Italic</label>
  </div>
  <div class="slider-container flex-row">
    <label>Line 2 font: 
      <select id="font2"><option>Arial</option><option>Verdana</option><option>Courier New</option></select>
    </label>
    <label><input type="checkbox" id="bold2"> Bold</label>
    <label><input type="checkbox" id="italic2" checked> Italic</label>
  </div>
  <div class="slider-container flex-row">
    <label>Line 3 font: 
      <select id="font3"><option>Arial</option><option>Verdana</option><option>Courier New</option></select>
    </label>
    <label><input type="checkbox" id="bold3"> Bold</label>
    <label><input type="checkbox" id="italic3"> Italic</label>
  </div>
</div>
</form>

<!-- Preview PNG canvas near top -->
<canvas id="labelCanvas" width="378" height="283"></canvas>

<h3>Additional Labels (Label 2+)</h3>
<label>Number of additional labels: <input id="numLabels" type="number" min="0" value="0"></label>
<div id="labelsContainer"></div>
<div class="flex-row">
  <button type="button" id="previewAllBtn">Preview All Labels</button>
  <button type="button" id="downloadAllBtn">Download Engraving Files</button>
</div>
<div id="allPreviews"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script>
const mmToPx = mm=>mm*3.78;
const canvas=document.getElementById('labelCanvas');
const ctx=canvas.getContext('2d');

const line1Input=document.getElementById('line1');
const line2Input=document.getElementById('line2');
const line3Input=document.getElementById('line3');
const largeSlider=document.getElementById('largeSize');
const smallSlider=document.getElementById('smallSize');
const line3Slider=document.getElementById('line3Size');
const link23Checkbox=document.getElementById('link23');
const gap12Slider=document.getElementById('gap12');
const gap23Slider=document.getElementById('gap23');
const linkGapsCheckbox=document.getElementById('linkGaps');
const textShiftSlider=document.getElementById('textShift');
const font1Select=document.getElementById('font1');
const font2Select=document.getElementById('font2');
const font3Select=document.getElementById('font3');
const bold1=document.getElementById('bold1');
const italic1=document.getElementById('italic1');
const bold2=document.getElementById('bold2');
const italic2=document.getElementById('italic2');
const bold3=document.getElementById('bold3');
const italic3=document.getElementById('italic3');

const largeLabel=document.getElementById('largeSizeLabel');
const smallLabel=document.getElementById('smallSizeLabel');
const line3Label=document.getElementById('line3SizeLabel');
const gap12Label=document.getElementById('gap12Label');
const gap23Label=document.getElementById('gap23Label');
const textShiftLabel=document.getElementById('textShiftLabel');

const toggleAdvancedBtn=document.getElementById('toggleAdvanced');
const advancedDiv=document.getElementById('advancedOptions');
toggleAdvancedBtn.addEventListener('click',()=>{
  if(advancedDiv.style.display==='none'){advancedDiv.style.display='block'; toggleAdvancedBtn.textContent='Hide Advanced Options';}
  else{advancedDiv.style.display='none'; toggleAdvancedBtn.textContent='Show Advanced Options';}
});

// Additional labels data
let labels=[];

// Render additional label inputs
function renderLabelInputs(){
    const n = parseInt(document.getElementById('numLabels').value);
    const container=document.getElementById('labelsContainer');
    container.innerHTML='';
    labels=[];
    for(let i=0;i<n;i++){
        const div=document.createElement('div');
        div.innerHTML=`<h4>Label ${i+2}</h4>
        <label>Line 1: <input class="line1multi" value="1st line"></label>
        <label>Line 2: <input class="line2multi" value="2nd line"></label>
        <label>Line 3: <input class="line3multi" value="3rd line"></label>`;
        container.appendChild(div);
        labels.push({line1:'1st line', line2:'2nd line', line3:'3rd line'});
    }
}
document.getElementById('numLabels').addEventListener('change',renderLabelInputs);
renderLabelInputs();

// Update data from inputs
function updateLabelsData(){
    const line1s=document.querySelectorAll('.line1multi');
    const line2s=document.querySelectorAll('.line2multi');
    const line3s=document.querySelectorAll('.line3multi');
    labels.forEach((l,i)=>{
        l.line1=line1s[i].value;
        l.line2=line2s[i].value;
        l.line3=line3s[i].value;
    });
}

// Update slider labels only (no preview)
function updateLabelsDisplay(){
    largeLabel.textContent=largeSlider.value;
    smallLabel.textContent=smallSlider.value;
    line3Label.textContent=line3Slider.value;
    gap12Label.textContent=gap12Slider.value;
    gap23Label.textContent=gap23Slider.value;
    textShiftLabel.textContent=textShiftSlider.value;
}

// Attach slider label updates only
[largeSlider, smallSlider, line3Slider, gap12Slider, gap23Slider, textShiftSlider].forEach(el => 
  el.addEventListener('input', updateLabelsDisplay)
);
[line1Input,line2Input,line3Input].forEach(el=>el.addEventListener('input',()=>{})); // no preview update

// The rest of the functions (drawLabel, previewAllLabels, generateSVG, downloadAllSVGs) remain exactly as before
// ... you can reuse all previous JS code for these functions here, unchanged

// Event listeners for buttons
document.getElementById('labelForm').addEventListener('submit', e=>{
    e.preventDefault();
    drawLabel({line1:line1Input.value,line2:line2Input.value,line3:line3Input.value});
});
document.getElementById('previewAllBtn').addEventListener('click', previewAllLabels);
document.getElementById('downloadAllBtn').addEventListener('click', downloadAllSVGs);

// Initial render
updateLabelsDisplay();
drawLabel({line1:line1Input.value,line2:line2Input.value,line3:line3Input.value});
</script>
</body>
</html>

